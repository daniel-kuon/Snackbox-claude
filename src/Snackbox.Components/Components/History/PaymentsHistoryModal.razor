@using Snackbox.Api.Dtos
@inherits ComponentBase

@if (IsOpen)
{
    <div class="sb-modal-backdrop" @onclick="Close"></div>
    <div class="sb-modal">
        <div class="sb-modal-header">
            <h3>All Payments</h3>
            <button class="sb-close" @onclick="Close">Ã—</button>
        </div>
        <div class="sb-modal-body">
            @if (Payments == null || !Payments.Any())
            {
                <div class="sb-empty">No payments</div>
            }
            else
            {
                @foreach (var p in Payments.OrderByDescending(p => p.PaidAt))
                {
                    <div class="sb-row">
                        <div class="sb-row-left">
                            <div class="sb-date">@p.PaidAt.ToString("dd MMM yyyy HH:mm")</div>
                            <div class="sb-sub">@p.Type</div>
                        </div>
                        <div class="sb-amount">@p.Amount.ToString("C")</div>
                    </div>
                }
            }
        </div>
    </div>
}

@code {
    [Parameter] public bool IsOpen { get; set; }
    [Parameter] public EventCallback OnClose { get; set; }
    [Parameter] public IEnumerable<PaymentDto>? Payments { get; set; }

    private void Close() => OnClose.InvokeAsync();
}

<style>
    .sb-modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 1000; }
    .sb-modal {
        position: fixed; top: 5vh; left: 50%; transform: translateX(-50%);
        width: min(700px, 94vw); max-height: 90vh; overflow: hidden;
        background: #fff; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.25); z-index: 1001;
        display: flex; flex-direction: column;
    }
    .sb-modal-header { display: flex; align-items: center; gap: .5rem; padding: 1rem 1.25rem; border-bottom: 1px solid #eee; }
    .sb-modal-header h3 { margin: 0; font-size: 1.1rem; }
    .sb-close { margin-left: auto; border: none; background: transparent; font-size: 1.5rem; cursor: pointer; line-height: 1; }
    .sb-modal-body { padding: .75rem 0; overflow: auto; }
    .sb-empty { padding: 1rem 1.25rem; color: #666; }
    .sb-row { display: flex; align-items: center; justify-content: space-between; padding: .5rem .75rem; border-radius: 8px; }
    .sb-row:hover { background: #f8f9fa; }
    .sb-row-left { display: flex; flex-direction: column; }
    .sb-date { font-size: .95rem; color: #333; }
    .sb-sub { font-size: .8rem; color: #666; }
    .sb-amount { font-weight: 600; }
    @@media (max-width: 520px) { .sb-modal { top: 2vh; max-height: 96vh; } }
</style>
